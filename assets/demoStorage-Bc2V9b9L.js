import{K as n,J as i}from"./index-WVObp_XA.js";const e={ORDERS:"demo_orders",MENU_SCANS:"demo_menu_scans",MENU_VIEWS:"demo_menu_views",ITEM_CLICKS:"demo_item_clicks"};function g(){localStorage.getItem(e.ORDERS)||localStorage.setItem(e.ORDERS,JSON.stringify([...n])),localStorage.getItem(e.MENU_SCANS)||localStorage.setItem(e.MENU_SCANS,JSON.stringify([])),localStorage.getItem(e.MENU_VIEWS)||localStorage.setItem(e.MENU_VIEWS,JSON.stringify([])),localStorage.getItem(e.ITEM_CLICKS)||localStorage.setItem(e.ITEM_CLICKS,JSON.stringify({}))}const m={getAll(){try{const r=localStorage.getItem(e.ORDERS);return r?JSON.parse(r):[...n]}catch(r){return console.error("Error reading orders from localStorage:",r),[...n]}},add(r){try{const t=this.getAll();return t.unshift(r),t.length>100&&t.splice(100),localStorage.setItem(e.ORDERS,JSON.stringify(t)),r}catch(t){throw console.error("Error saving order to localStorage:",t),t}},update(r,t){try{const o=this.getAll(),a=o.findIndex(c=>c.orderId===r);return a!==-1?(o[a]={...o[a],...t},localStorage.setItem(e.ORDERS,JSON.stringify(o)),o[a]):null}catch(o){throw console.error("Error updating order in localStorage:",o),o}},getById(r){return this.getAll().find(o=>o.orderId===r)||null},getRecent(r=10){return this.getAll().slice(0,r)}},I={trackScan(r){try{const t=this.getScans();t.push({qrToken:r,timestamp:new Date().toISOString()}),t.length>1e3&&t.splice(0,t.length-1e3),localStorage.setItem(e.MENU_SCANS,JSON.stringify(t))}catch(t){console.error("Error tracking scan:",t)}},trackView(r){try{const t=this.getViews();t.push({menuId:r,timestamp:new Date().toISOString()}),t.length>1e3&&t.splice(0,t.length-1e3),localStorage.setItem(e.MENU_VIEWS,JSON.stringify(t))}catch(t){console.error("Error tracking view:",t)}},trackClick(r){try{const t=this.getClicks();t[r]=(t[r]||0)+1,localStorage.setItem(e.ITEM_CLICKS,JSON.stringify(t))}catch(t){console.error("Error tracking click:",t)}},trackOrder(){},getScans(){try{const r=localStorage.getItem(e.MENU_SCANS);return r?JSON.parse(r):[]}catch{return[]}},getViews(){try{const r=localStorage.getItem(e.MENU_VIEWS);return r?JSON.parse(r):[]}catch{return[]}},getClicks(){try{const r=localStorage.getItem(e.ITEM_CLICKS);return r?JSON.parse(r):{}}catch{return{}}},getTopItems(r=10){const t=this.getClicks(),o=Object.entries(t).map(([c,s])=>({itemName:c,clicks:s})).sort((c,s)=>s.clicks-c.clicks).slice(0,r),a=i.topItems||[];return o.map(c=>{const s=a.find(l=>l.itemName===c.itemName);return{itemName:c.itemName,scans:(s==null?void 0:s.scans)||Math.floor(c.clicks*1.3),clicks:c.clicks,category:(s==null?void 0:s.category)||"general"}}).slice(0,r)}};typeof window<"u"&&g();export{m as a,I as d};
