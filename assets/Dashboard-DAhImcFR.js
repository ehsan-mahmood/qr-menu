import{k as h,c as r,j as l,d as t,e as R,t as o,F as S,m as C,f as dt,r as A,h as V,p as ct,n as I,q as vt,_ as ft,x as ht,y as $t,z as _t,u as wt,o as kt,E as St,C as Ct,H as At,T as nt,A as L,g as U,b as It,l as q,v as Y,w as Ot,i as Tt,a as Rt}from"./index-WVObp_XA.js";import{u as Dt}from"./analyticsStore-DDAUZ-3q.js";import{o as Mt}from"./orderService-CP7Oea7D.js";import"./demoStorage-Bc2V9b9L.js";const Nt={class:"card"},jt={class:"text-lg font-bold mb-4"},Lt={class:"space-y-3"},Vt={class:"flex items-center gap-3"},Pt={class:"flex items-center justify-center w-8 h-8 rounded-full bg-primary-100 text-primary-700 font-bold text-sm"},Et={class:"font-medium text-gray-900"},Ft={class:"flex items-center gap-6 text-sm"},Ut={class:"text-right"},Ht={class:"font-bold text-gray-900"},zt={class:"text-right"},Bt={class:"font-bold text-primary-600"},qt={key:0,class:"text-center py-8 text-gray-500"},Wt={__name:"TopItems",props:{title:{type:String,default:"Top Items"},items:{type:Array,required:!0},limit:{type:Number,default:10}},setup(d){const m=d,u=h(()=>m.items.slice(0,m.limit));return(g,y)=>(l(),r("div",Nt,[t("h3",jt,o(d.title),1),t("div",Lt,[(l(!0),r(S,null,C(u.value,(v,i)=>(l(),r("div",{key:i,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors"},[t("div",Vt,[t("span",Pt,o(i+1),1),t("span",Et,o(v.itemName),1)]),t("div",Ft,[t("div",Ut,[y[0]||(y[0]=t("div",{class:"text-gray-500"},"Scans",-1)),t("div",Ht,o(v.scans),1)]),t("div",zt,[y[1]||(y[1]=t("div",{class:"text-gray-500"},"Clicks",-1)),t("div",Bt,o(v.clicks),1)])])]))),128))]),u.value.length===0?(l(),r("div",qt," No items to display ")):R("",!0)]))}},Jt={class:"card"},Qt={class:"text-lg font-bold mb-4"},Xt={class:"overflow-x-auto"},Gt={class:"w-full"},Kt={class:"border-b border-gray-200"},Yt={key:0,class:"text-center py-8 text-gray-500"},Zt={__name:"AnalyticsTable",props:{title:{type:String,default:"Analytics"},columns:{type:Array,required:!0},data:{type:Array,required:!0}},setup(d){const m=(u,g)=>{if(!g)return u;switch(g){case"currency":return`$${Number(u).toFixed(2)}`;case"number":return Number(u).toLocaleString();default:return u}};return(u,g)=>(l(),r("div",Jt,[t("h3",Qt,o(d.title),1),t("div",Xt,[t("table",Gt,[t("thead",null,[t("tr",Kt,[(l(!0),r(S,null,C(d.columns,y=>(l(),r("th",{key:y.key,class:"text-left py-3 px-4 font-semibold text-gray-700"},o(y.label),1))),128))])]),t("tbody",null,[(l(!0),r(S,null,C(d.data,(y,v)=>(l(),r("tr",{key:v,class:"border-b border-gray-100 hover:bg-gray-50 transition-colors"},[(l(!0),r(S,null,C(d.columns,i=>(l(),r("td",{key:i.key,class:"py-3 px-4 text-gray-900"},o(m(y[i.key],i.format)),1))),128))]))),128))])])]),d.data.length===0?(l(),r("div",Yt," No data available ")):R("",!0)]))}},te={class:"card"},ee={class:"text-lg font-bold mb-4"},se={key:0,class:"space-y-4"},ae={class:"relative",style:{height:"300px"}},le=["y1","x2","y2"],re=["x","y","width","height"],oe=["x","y","width","height"],ne=["x","y"],ie=["x","y"],de={class:"mt-4 p-4 bg-blue-50 rounded-lg"},ce={class:"grid grid-cols-2 gap-2 text-sm"},ue={class:"text-blue-900 ml-2"},ye={class:"text-blue-900 ml-2"},ge={key:1,class:"text-center py-8 text-gray-500"},O=40,Z=800,it=2,me={__name:"PeakHoursChart",props:{title:{type:String,default:"Peak Hours Analysis"},data:{type:Array,default:()=>[]}},setup(d){const m=d,u=300-O*2,g=(Z-O*2)/m.data.length,y=h(()=>Math.max(...m.data.map(a=>a.orders),1)),v=h(()=>Math.max(...m.data.map(a=>a.scans),1)),i=h(()=>!m.data||m.data.length===0?{hourLabel:"N/A",orders:0,scans:0}:m.data.reduce((a,n)=>{const x=n.orders+n.scans,w=a.orders+a.scans;return x>w?n:a},m.data[0]));return(a,n)=>(l(),r("div",te,[t("h3",ee,o(d.title),1),d.data&&d.data.length>0?(l(),r("div",se,[t("div",ae,[(l(),r("svg",{width:Z,height:300,class:"w-full"},[(l(),r(S,null,C(5,x=>t("g",{key:x,class:"text-gray-300"},[t("line",{x1:O,y1:O+(x-1)*(u/4),x2:Z-O,y2:O+(x-1)*(u/4),stroke:"#e5e7eb","stroke-width":"1"},null,8,le)])),64)),(l(!0),r(S,null,C(d.data,(x,w)=>(l(),r("g",{key:`order-${w}`},[t("rect",{x:O+w*g+it,y:u-O-x.orders/y.value*u,width:g*.4,height:x.orders/y.value*u,fill:"#3b82f6",opacity:.7,class:"hover:opacity-100 transition-opacity"},[t("title",null,o(x.hourLabel)+": "+o(x.orders)+" orders",1)],8,re)]))),128)),(l(!0),r(S,null,C(d.data,(x,w)=>(l(),r("g",{key:`scan-${w}`},[t("rect",{x:O+w*g+it+g*.4,y:u-O-x.scans/v.value*u,width:g*.4,height:x.scans/v.value*u,fill:"#10b981",opacity:.7,class:"hover:opacity-100 transition-opacity"},[t("title",null,o(x.hourLabel)+": "+o(x.scans)+" scans",1)],8,oe)]))),128)),a.index%2===0?(l(!0),r(S,{key:0},C(d.data,(x,w)=>(l(),r("g",{key:`label-${w}`},[t("text",{x:O+w*g+g/2,y:u-O+20,"text-anchor":"middle",class:"text-xs fill-gray-600"},o(x.hourLabel),9,ne)]))),128)):R("",!0),(l(),r(S,null,C(5,x=>t("g",{key:`y-label-${x}`},[t("text",{x:O-10,y:O+(x-1)*(u/4)+4,"text-anchor":"end",class:"text-xs fill-gray-600"},o(Math.round(y.value*(1-(x-1)/4))),9,ie)])),64))]))]),n[3]||(n[3]=dt('<div class="flex items-center justify-center gap-6 text-sm"><div class="flex items-center gap-2"><div class="w-4 h-4 bg-blue-500 opacity-70 rounded"></div><span class="text-gray-700">Orders</span></div><div class="flex items-center gap-2"><div class="w-4 h-4 bg-green-500 opacity-70 rounded"></div><span class="text-gray-700">Scans</span></div></div>',1)),t("div",de,[n[2]||(n[2]=t("h4",{class:"font-semibold text-blue-900 mb-2"},"ðŸ“Š Peak Hours",-1)),t("div",ce,[t("div",null,[n[0]||(n[0]=t("span",{class:"text-blue-700 font-medium"},"Busiest Hour:",-1)),t("span",ue,o(i.value.hourLabel),1)]),t("div",null,[n[1]||(n[1]=t("span",{class:"text-blue-700 font-medium"},"Total Activity:",-1)),t("span",ye,o(i.value.orders+i.value.scans)+" events",1)])])])])):(l(),r("div",ge," No hourly data available "))]))}},xe={class:"card"},pe={class:"text-lg font-bold mb-4"},be={key:0,class:"space-y-4"},ve={class:"flex items-center gap-2 mb-4"},fe=["value"],he={class:"relative",style:{height:"300px"}},$e=["y1","x2","y2"],_e=["points"],we=["points"],ke=["cx","cy"],Se=["cx","cy"],Ce=["x","y"],Ae=["x","y"],Ie={class:"mt-4 p-4 bg-green-50 rounded-lg"},Oe={class:"grid grid-cols-2 gap-2 text-sm"},Te={class:"text-green-900 ml-2"},Re={key:1,class:"text-center py-8 text-gray-500"},T=40,tt=800,De={__name:"TrendChart",props:{title:{type:String,default:"Trend Visualization"},data:{type:Array,default:()=>[]}},setup(d){const m=d,u=A(""),g=h(()=>{if(!m.data||m.data.length===0)return[];const p=new Set;return m.data.forEach(b=>{var c;(c=b.items)==null||c.forEach(f=>{p.add(f.itemName)})}),Array.from(p)}),y=h(()=>!u.value||!m.data?m.data:m.data.map(p=>{var b;return{...p,items:((b=p.items)==null?void 0:b.filter(c=>c.itemName===u.value))||[]}})),v=300-T*2,i=(tt-T*2)/Math.max(y.value.length-1,1),a=h(()=>{let p=0;return y.value.forEach(b=>{var c;(c=b.items)==null||c.forEach(f=>{p=Math.max(p,f.scans||0,f.clicks||0)})}),Math.max(p,1)}),n=h(()=>y.value.map((p,b)=>{var k;const c=(k=p.items)==null?void 0:k[0],f=(c==null?void 0:c.scans)||0;return{x:T+b*i+i/2,y:v-T-f/a.value*v,value:f,label:p.dateLabel}})),x=h(()=>y.value.map((p,b)=>{var k;const c=(k=p.items)==null?void 0:k[0],f=(c==null?void 0:c.clicks)||0;return{x:T+b*i+i/2,y:v-T-f/a.value*v,value:f,label:p.dateLabel}})),w=h(()=>n.value.map(p=>`${p.x},${p.y}`).join(" ")),M=h(()=>x.value.map(p=>`${p.x},${p.y}`).join(" ")),D=h(()=>{if(!y.value||y.value.length===0)return 0;const p=y.value.reduce((b,c)=>{var k;const f=(k=c.items)==null?void 0:k[0];return b+((f==null?void 0:f.scans)||0)},0);return Math.round(p/y.value.length)}),N=h(()=>{var c,f,k,H;if(!y.value||y.value.length<2)return 0;const p=((f=(c=y.value[0].items)==null?void 0:c[0])==null?void 0:f.scans)||0,b=((H=(k=y.value[y.value.length-1].items)==null?void 0:k[0])==null?void 0:H.scans)||0;return p===0?b>0?100:0:(b-p)/p*100});return g.value.length>0&&!u.value&&(u.value=g.value[0]),(p,b)=>(l(),r("div",xe,[t("h3",pe,o(d.title),1),d.data&&d.data.length>0?(l(),r("div",be,[t("div",ve,[b[1]||(b[1]=t("label",{class:"text-sm font-medium text-gray-700"},"Item:",-1)),V(t("select",{"onUpdate:modelValue":b[0]||(b[0]=c=>u.value=c),class:"px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm"},[(l(!0),r(S,null,C(g.value,c=>(l(),r("option",{key:c,value:c},o(c),9,fe))),128))],512),[[ct,u.value]])]),t("div",he,[(l(),r("svg",{width:tt,height:300,class:"w-full"},[(l(),r(S,null,C(5,c=>t("g",{key:c,class:"text-gray-300"},[t("line",{x1:T,y1:T+(c-1)*(v/4),x2:tt-T,y2:T+(c-1)*(v/4),stroke:"#e5e7eb","stroke-width":"1"},null,8,$e)])),64)),t("polyline",{points:w.value,fill:"none",stroke:"#3b82f6","stroke-width":"3",class:"drop-shadow-sm"},null,8,_e),t("polyline",{points:M.value,fill:"none",stroke:"#10b981","stroke-width":"3",class:"drop-shadow-sm"},null,8,we),(l(!0),r(S,null,C(n.value,(c,f)=>(l(),r("g",{key:`scan-point-${f}`},[t("circle",{cx:c.x,cy:c.y,r:"5",fill:"#3b82f6",class:"hover:r-7 transition-all cursor-pointer"},[t("title",null,o(c.label)+": "+o(c.value)+" scans",1)],8,ke)]))),128)),(l(!0),r(S,null,C(x.value,(c,f)=>(l(),r("g",{key:`click-point-${f}`},[t("circle",{cx:c.x,cy:c.y,r:"5",fill:"#10b981",class:"hover:r-7 transition-all cursor-pointer"},[t("title",null,o(c.label)+": "+o(c.value)+" clicks",1)],8,Se)]))),128)),(l(!0),r(S,null,C(y.value,(c,f)=>(l(),r("g",{key:`label-${f}`},[t("text",{x:T+f*i+i/2,y:v-T+20,"text-anchor":"middle",class:"text-xs fill-gray-600"},o(c.dateLabel),9,Ce)]))),128)),(l(),r(S,null,C(5,c=>t("g",{key:`y-label-${c}`},[t("text",{x:T-10,y:T+(c-1)*(v/4)+4,"text-anchor":"end",class:"text-xs fill-gray-600"},o(Math.round(a.value*(1-(c-1)/4))),9,Ae)])),64))]))]),b[5]||(b[5]=dt('<div class="flex items-center justify-center gap-6 text-sm"><div class="flex items-center gap-2"><div class="w-4 h-4 bg-blue-500 rounded-full"></div><span class="text-gray-700">Scans</span></div><div class="flex items-center gap-2"><div class="w-4 h-4 bg-green-500 rounded-full"></div><span class="text-gray-700">Clicks</span></div></div>',1)),t("div",Ie,[b[4]||(b[4]=t("h4",{class:"font-semibold text-green-900 mb-2"},"ðŸ“ˆ Trend Analysis",-1)),t("div",Oe,[t("div",null,[b[2]||(b[2]=t("span",{class:"text-green-700 font-medium"},"7-Day Change:",-1)),t("span",{class:I([N.value>=0?"text-green-900":"text-red-600","ml-2"])},o(N.value>=0?"+":"")+o(N.value.toFixed(1))+"% ",3)]),t("div",null,[b[3]||(b[3]=t("span",{class:"text-green-700 font-medium"},"Average Daily:",-1)),t("span",Te,o(D.value)+" scans",1)])])])])):(l(),r("div",Re," No trend data available "))]))}},Me={class:"card"},Ne={class:"text-lg font-bold mb-4"},je={key:0,class:"space-y-4"},Le={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Ve={class:"flex items-center justify-between mb-3"},Pe={class:"font-bold text-gray-900 capitalize"},Ee={class:"text-2xl"},Fe={class:"space-y-2 text-sm"},Ue={class:"flex justify-between"},He={class:"font-semibold text-gray-900"},ze={class:"flex justify-between"},Be={class:"font-semibold text-blue-600"},qe={class:"flex justify-between"},We={class:"font-semibold text-green-600"},Je={class:"flex justify-between border-t border-gray-300 pt-2 mt-2"},Qe={class:"font-bold text-purple-600"},Xe={class:"mt-3 pt-3 border-t border-gray-300"},Ge={class:"flex items-center justify-between"},Ke={class:"mt-1 h-2 bg-gray-200 rounded-full overflow-hidden"},Ye={class:"mt-6 overflow-x-auto"},Ze={class:"w-full"},ts={class:"py-3 px-4 font-medium text-gray-900 capitalize"},es={class:"py-3 px-4 text-right text-gray-700"},ss={class:"py-3 px-4 text-right text-blue-600 font-medium"},as={class:"py-3 px-4 text-right text-green-600 font-medium"},ls={class:"py-3 px-4 text-right text-purple-600 font-semibold"},rs={class:"py-3 px-4 text-right"},os={key:1,class:"text-center py-8 text-gray-500"},ns={__name:"CategoryAnalytics",props:{title:{type:String,default:"Category Analytics"},data:{type:Array,default:()=>[]}},setup(d){const m=d,u=i=>({breakfast:"ðŸ³",mains:"ðŸ½ï¸",drinks:"â˜•",salads:"ðŸ¥—",desserts:"ðŸ°"})[i]||"ðŸ“¦",g=i=>i.totalScans===0?0:(i.totalOrders/i.totalScans*100).toFixed(1),y=i=>{const a=parseFloat(g(i));return a>=20?"text-green-600":a>=10?"text-yellow-600":"text-red-600"},v=h(()=>[...m.data].sort((i,a)=>a.totalOrders-i.totalOrders));return(i,a)=>(l(),r("div",Me,[t("h3",Ne,o(d.title),1),d.data&&d.data.length>0?(l(),r("div",je,[t("div",Le,[(l(!0),r(S,null,C(d.data,(n,x)=>(l(),r("div",{key:x,class:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-lg p-4 border border-gray-200 hover:shadow-md transition-shadow"},[t("div",Ve,[t("h4",Pe,o(n.category),1),t("span",Ee,o(u(n.category)),1)]),t("div",Fe,[t("div",Ue,[a[0]||(a[0]=t("span",{class:"text-gray-600"},"Scans:",-1)),t("span",He,o(n.totalScans.toLocaleString()),1)]),t("div",ze,[a[1]||(a[1]=t("span",{class:"text-gray-600"},"Clicks:",-1)),t("span",Be,o(n.totalClicks.toLocaleString()),1)]),t("div",qe,[a[2]||(a[2]=t("span",{class:"text-gray-600"},"Orders:",-1)),t("span",We,o(n.totalOrders.toLocaleString()),1)]),t("div",Je,[a[3]||(a[3]=t("span",{class:"text-gray-600"},"Avg Value:",-1)),t("span",Qe,"$"+o(n.avgOrderValue.toFixed(2)),1)])]),t("div",Xe,[t("div",Ge,[a[4]||(a[4]=t("span",{class:"text-xs text-gray-500"},"Conversion Rate:",-1)),t("span",{class:I(["text-xs font-semibold",y(n)])},o(g(n))+"% ",3)]),t("div",Ke,[t("div",{class:I(["h-full transition-all",y(n).replace("text-","bg-").replace("-600","-500")]),style:vt({width:`${g(n)}%`})},null,6)])])]))),128))]),t("div",Ye,[t("table",Ze,[a[5]||(a[5]=t("thead",null,[t("tr",{class:"border-b border-gray-200"},[t("th",{class:"text-left py-3 px-4 font-semibold text-gray-700"},"Category"),t("th",{class:"text-right py-3 px-4 font-semibold text-gray-700"},"Scans"),t("th",{class:"text-right py-3 px-4 font-semibold text-gray-700"},"Clicks"),t("th",{class:"text-right py-3 px-4 font-semibold text-gray-700"},"Orders"),t("th",{class:"text-right py-3 px-4 font-semibold text-gray-700"},"Avg Value"),t("th",{class:"text-right py-3 px-4 font-semibold text-gray-700"},"Conversion")])],-1)),t("tbody",null,[(l(!0),r(S,null,C(v.value,(n,x)=>(l(),r("tr",{key:x,class:"border-b border-gray-100 hover:bg-gray-50 transition-colors"},[t("td",ts,o(n.category),1),t("td",es,o(n.totalScans.toLocaleString()),1),t("td",ss,o(n.totalClicks.toLocaleString()),1),t("td",as,o(n.totalOrders.toLocaleString()),1),t("td",ls,"$"+o(n.avgOrderValue.toFixed(2)),1),t("td",rs,[t("span",{class:I([y(n),"font-semibold"])},o(g(n))+"% ",3)])]))),128))])])])])):(l(),r("div",os," No category data available "))]))}},is={class:"card"},ds={class:"text-lg font-bold flex items-center gap-2"},cs={class:"text-gray-400 text-sm flex items-center gap-1"},us={key:1},ys={class:"flex items-center justify-between mb-4"},gs={class:"text-lg font-bold"},ms={key:0,class:"flex flex-wrap gap-2"},xs={class:"text-lg"},ps={key:1,class:"text-center py-8 text-gray-500"},bs={__name:"InsightsPanel",props:{title:{type:String,default:"Insights & Recommendations"},insights:{type:Array,default:()=>[]}},setup(d){const m=A(!1),u=i=>({high_demand:"ðŸ“ˆ",trending_item:"ðŸ”¥",low_performance:"âš ï¸",prep_time:"â±ï¸",recommendation:"ðŸ’¡"})[i]||"ðŸ“Š",g=i=>{const a="bg-opacity-10";return i.priority==="high"?`bg-red-500 border-red-500 ${a}`:i.priority==="medium"?`bg-yellow-500 border-yellow-500 ${a}`:`bg-blue-500 border-blue-500 ${a}`},y=i=>i.priority==="high"?"text-red-900":i.priority==="medium"?"text-yellow-900":"text-blue-900",v=i=>i==="high"?"bg-red-100 text-red-800":i==="medium"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800";return(i,a)=>(l(),r("div",is,[m.value?(l(),r("div",us,[t("div",ys,[t("h3",gs,o(d.title),1),t("button",{onClick:a[1]||(a[1]=n=>m.value=!1),class:"text-sm text-gray-600 hover:text-gray-900 flex items-center gap-1 transition-colors"},[...a[3]||(a[3]=[t("span",null,"Collapse",-1),t("span",{class:"text-xs"},"â–²",-1)])])]),d.insights&&d.insights.length>0?(l(),r("div",ms,[(l(!0),r(S,null,C(d.insights,(n,x)=>(l(),r("div",{key:x,class:I(["flex items-center gap-2 px-3 py-2 rounded-lg border-l-4 transition-all hover:shadow-md hover:scale-105",g(n)])},[t("span",xs,o(u(n.type)),1),t("span",{class:I(["font-semibold text-sm whitespace-nowrap",y(n)])},o(n.title),3),t("span",{class:I(["px-2 py-0.5 rounded-full text-xs font-semibold whitespace-nowrap",v(n.priority)])},o(n.priority),3)],2))),128))])):(l(),r("div",ps," No insights available "))])):(l(),r("div",{key:0,onClick:a[0]||(a[0]=n=>m.value=!0),class:"flex items-center justify-between cursor-pointer hover:bg-gray-50 -m-4 p-4 rounded-lg transition-colors"},[t("h3",ds,[t("span",null,o(d.title.split(" ")[0]==="ðŸ’¡"?"ðŸ’¡":""),1),t("span",null,o(d.title.replace("ðŸ’¡ ","")),1)]),t("span",cs,[t("span",null,o(d.insights&&d.insights.length>0?`${d.insights.length} insights`:""),1),a[2]||(a[2]=t("span",{class:"text-xs"},"â–¼",-1))])]))]))}},vs={class:"card"},fs={class:"flex items-center justify-between mb-4"},hs={class:"text-lg font-bold"},$s={class:"flex items-center gap-2"},_s={class:"flex items-center gap-2 text-sm text-gray-600"},ws=["checked"],ks={key:0,class:"overflow-x-auto"},Ss={class:"w-full"},Cs={class:"py-3 px-4 font-medium text-gray-900"},As={class:"py-3 px-4 text-gray-600 font-mono text-sm"},Is={class:"py-3 px-4 text-right font-semibold text-gray-900"},Os={class:"py-3 px-4"},Ts={class:"py-3 px-4 text-sm text-gray-600"},Rs={key:1,class:"text-center py-8 text-gray-500"},Ds={__name:"RecentOrders",props:{title:{type:String,default:"Recent Orders"},orders:{type:Array,default:()=>[]},newOrderIds:{type:Set,default:()=>new Set},autoRefresh:{type:Boolean,default:!1}},emits:["refresh","update:autoRefresh"],setup(d){const m=d,u=i=>{const a=[];return m.newOrderIds&&m.newOrderIds.has(i.orderId)&&a.push("bg-green-50 border-l-4 border-green-500"),a.push("hover:bg-gray-50"),a.join(" ")},g=i=>({pending:"bg-yellow-100 text-yellow-800",preparing:"bg-blue-100 text-blue-800",ready:"bg-green-100 text-green-800",served:"bg-purple-100 text-purple-800",cancelled:"bg-red-100 text-red-800"})[i]||"bg-gray-100 text-gray-800",y=i=>({pending:"Pending",preparing:"Preparing",ready:"Ready",served:"Served",cancelled:"Cancelled"})[i]||i,v=i=>{if(!i)return"N/A";const a=new Date(i),x=new Date-a,w=Math.floor(x/6e4);if(w<1)return"Just now";if(w<60)return`${w}m ago`;const M=Math.floor(w/60);return M<24?`${M}h ago`:a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})};return(i,a)=>(l(),r("div",vs,[t("div",fs,[t("h3",hs,o(d.title),1),t("div",$s,[t("div",_s,[t("input",{type:"checkbox",id:"autoRefreshOrders",checked:d.autoRefresh,onChange:a[0]||(a[0]=n=>i.$emit("update:autoRefresh",n.target.checked)),class:"rounded cursor-pointer",title:"Automatically refresh orders every 10 seconds"},null,40,ws),a[2]||(a[2]=t("label",{for:"autoRefreshOrders",class:"cursor-pointer"}," Auto-refresh ",-1))]),t("button",{onClick:a[1]||(a[1]=n=>i.$emit("refresh")),class:"text-sm px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded transition-colors",title:"Refresh orders"}," ðŸ”„ Refresh ")])]),d.orders&&d.orders.length>0?(l(),r("div",ks,[t("table",Ss,[a[3]||(a[3]=t("thead",null,[t("tr",{class:"border-b border-gray-200"},[t("th",{class:"text-left py-3 px-4 font-semibold text-gray-700"},"Table"),t("th",{class:"text-left py-3 px-4 font-semibold text-gray-700"},"Order #"),t("th",{class:"text-right py-3 px-4 font-semibold text-gray-700"},"Amount"),t("th",{class:"text-left py-3 px-4 font-semibold text-gray-700"},"Status"),t("th",{class:"text-left py-3 px-4 font-semibold text-gray-700"},"Time")])],-1)),t("tbody",null,[(l(!0),r(S,null,C(d.orders,n=>(l(),r("tr",{key:n.orderId,class:I(["border-b border-gray-100 transition-all",u(n)])},[t("td",Cs," Table "+o(n.tableNumber||"N/A"),1),t("td",As," #"+o(n.orderId.slice(-6)),1),t("td",Is," $"+o(n.totalAmount.toFixed(2)),1),t("td",Os,[t("span",{class:I(["px-2 py-1 rounded-full text-xs font-semibold",g(n.status)])},o(y(n.status)),3)]),t("td",Ts,o(v(n.createdAt)),1)],2))),128))])])])):(l(),r("div",Rs," No recent orders "))]))}},Ms={class:"flex items-start gap-3"},Ns={class:"text-2xl"},js={class:"flex-1"},Ls={class:"font-bold text-gray-900"},Vs={class:"text-sm text-gray-700 mt-1"},Ps={__name:"ToastNotification",props:{notification:{type:Object,default:null}},emits:["close"],setup(d){const m=g=>({new_order:"ðŸ›’",order_update:"ðŸ“‹",info:"â„¹ï¸",success:"âœ…",warning:"âš ï¸",error:"âŒ"})[g]||"ðŸ””",u=g=>({new_order:"border-green-500 bg-green-50",order_update:"border-blue-500 bg-blue-50",info:"border-blue-500 bg-blue-50",success:"border-green-500 bg-green-50",warning:"border-yellow-500 bg-yellow-50",error:"border-red-500 bg-red-50"})[g]||"border-gray-500 bg-gray-50";return(g,y)=>(l(),ht(_t,{name:"toast"},{default:$t(()=>[d.notification?(l(),r("div",{key:0,class:I(["fixed top-4 right-4 z-50 bg-white border-l-4 shadow-lg rounded-lg px-6 py-4 min-w-[300px] max-w-md animate-slide-in",u(d.notification.type)])},[t("div",Ms,[t("span",Ns,o(m(d.notification.type)),1),t("div",js,[t("p",Ls,o(d.notification.title),1),t("p",Vs,o(d.notification.message),1)]),t("button",{onClick:y[0]||(y[0]=v=>g.$emit("close")),class:"ml-2 px-2 py-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded transition-colors",title:"Close notification","aria-label":"Close notification"}," âœ• ")])],2)):R("",!0)]),_:1}))}},Es=ft(Ps,[["__scopeId","data-v-3821ae9a"]]),Fs={class:"min-h-screen bg-gray-50"},Us={class:"bg-white shadow-sm"},Hs={class:"container mx-auto px-4 py-4"},zs={class:"flex items-center justify-between mb-4"},Bs={class:"flex items-center gap-4"},qs={key:0,class:"text-sm text-gray-500"},Ws={class:"flex gap-2 border-b border-gray-200"},Js={class:"container mx-auto px-4 py-6 max-w-6xl"},Qs={key:0,class:"mb-6 card bg-yellow-50 border border-yellow-200"},Xs={key:1,class:"text-center py-12"},Gs={key:2,class:"card bg-red-50 border border-red-200 text-center"},Ks={class:"text-red-700 mb-4"},Ys={key:3},Zs={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6"},ta={class:"card bg-gradient-to-br from-blue-500 to-blue-600 text-white"},ea={class:"flex items-center justify-between"},sa={class:"text-3xl font-bold"},aa={class:"card bg-gradient-to-br from-green-500 to-green-600 text-white"},la={class:"flex items-center justify-between"},ra={class:"text-3xl font-bold"},oa={class:"card bg-gradient-to-br from-purple-500 to-purple-600 text-white"},na={class:"flex items-center justify-between"},ia={class:"text-3xl font-bold"},da={class:"card bg-gradient-to-br from-orange-500 to-orange-600 text-white"},ca={class:"flex items-center justify-between"},ua={class:"text-3xl font-bold"},ya={class:"mb-6 flex flex-wrap gap-3"},ga={key:0,class:"mb-6"},ma={key:1,class:"mb-6"},xa={key:2,class:"mb-6"},pa={key:3,class:"mb-6"},ba={class:"mb-6"},va={class:"mb-6"},fa={class:"mt-6 card"},ha={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},$a={class:"mt-6 card bg-gray-50"},_a={class:"text-sm text-gray-700 space-y-1"},wa={class:"mt-6 card bg-blue-50 border border-blue-200"},ka={class:"bg-white p-3 rounded border border-blue-200 mb-3"},Sa={class:"text-sm text-gray-900 break-all"},Ca={class:"bg-white rounded-lg p-6 max-w-md w-full mx-4"},Aa={class:"space-y-4"},Ia={class:"flex items-center gap-2"},Oa={class:"mt-6 flex gap-3"},Ta=["disabled"],ja={__name:"Dashboard",setup(d){const m=It();Rt();const u=Dt(),g=wt(),y=nt,v=A(""),i=A(""),a=A(!1),n=A(""),x=A("weekly"),w=A(!1),M=A(!1),D=A(""),N=A(""),p=A([]),b=A(new Set),c=A(!0),f=A(null);let k=null;const H=h(()=>u.loading),et=h(()=>u.error),W=h(()=>{var s,e;return((s=g.user)==null?void 0:s.restaurantName)||((e=g.user)==null?void 0:e.name)}),J=h(()=>{var s;return g.merchantId||((s=g.user)==null?void 0:s.merchantId)}),z=h(()=>u.topItems),st=h(()=>u.totalScans),at=h(()=>u.totalOrders),lt=h(()=>u.avgOrderValue),rt=h(()=>{var s;return((s=u.dashboardData)==null?void 0:s.avgOrderPrepTime)||0}),P=h(()=>{var s;return((s=u.dashboardData)==null?void 0:s.peakHours)||[]}),Q=h(()=>{var s;return((s=u.dashboardData)==null?void 0:s.trendData)||[]}),E=h(()=>{var s;return((s=u.dashboardData)==null?void 0:s.categoryAnalytics)||[]}),X=h(()=>{var s;return((s=u.dashboardData)==null?void 0:s.insights)||[]}),ut=[{key:"itemName",label:"Item Name"},{key:"scans",label:"Scans",format:"number"},{key:"clicks",label:"Clicks",format:"number"}],B=async()=>{try{const s=J.value;if(!s)return;const e=new Set(p.value.map(_=>_.orderId)),j=(await Mt.getRecentOrders(s,10)).data||[],F=j.filter(_=>!e.has(_.orderId));p.value=j,F.length>0&&e.size>0&&(F.forEach(_=>{b.value.add(_.orderId),yt("new_order","New Order!",`New order at Table ${_.tableNumber||"N/A"}`)}),setTimeout(()=>{F.forEach(_=>{b.value.delete(_.orderId)})},5e3))}catch(s){console.error("Failed to load recent orders:",s)}},yt=(s,e,$)=>{f.value={type:s,title:e,message:$},setTimeout(()=>{f.value=null},5e3)},gt=()=>{f.value=null};kt(()=>{const s=new Date,e=new Date(s);e.setDate(s.getDate()-30),i.value=s.toISOString().split("T")[0],v.value=e.toISOString().split("T")[0],G(),B(),c.value&&(k=setInterval(()=>{B()},1e4))}),St(()=>{k&&clearInterval(k)}),Ct(c,s=>{s?k=setInterval(()=>{B()},1e4):k&&(clearInterval(k),k=null)});const G=async()=>{try{const s=J.value;if(!s){console.error("No merchant ID available");return}await u.fetchDashboardData(s,{startDate:v.value,endDate:i.value})}catch(s){console.error("Failed to load dashboard:",s)}},mt=async()=>{await g.logout(),m.push("/")},K=h(()=>{const s="/qr-menu/",e=s.endsWith("/")?s.slice(0,-1):s,$=nt?At.menuId:"menu-001";return`${window.location.origin}${e}/menu/${$}`}),xt=async()=>{try{await navigator.clipboard.writeText(K.value),alert("âœ… Menu URL copied to clipboard!")}catch(s){console.error("Failed to copy URL:",s),alert("Failed to copy URL. Please copy manually.")}},ot=async()=>{try{window.open(K.value,"_blank")}catch(s){console.error("Error viewing customer menu:",s),alert("Failed to open menu. Please try again.")}},pt=()=>{try{const s=[];s.push(["Item Name","Scans","Clicks","Category"].join(",")),z.value.forEach(_=>{s.push([`"${_.itemName||""}"`,_.scans||0,_.clicks||0,`"${_.category||"N/A"}"`].join(","))}),s.push([]),s.push(["Summary Statistics"].join(",")),s.push(["Metric","Value"].join(",")),s.push(["Total Scans",st.value].join(",")),s.push(["Total Orders",at.value].join(",")),s.push(["Avg Order Value",`$${lt.value.toFixed(2)}`].join(",")),s.push(["Avg Prep Time",`${rt.value.toFixed(1)} minutes`].join(",")),P.value.length>0&&(s.push([]),s.push(["Peak Hours Analysis"].join(",")),s.push(["Hour","Orders","Scans"].join(",")),P.value.forEach(_=>{s.push([_.hourLabel,_.orders,_.scans].join(","))})),E.value.length>0&&(s.push([]),s.push(["Category Analytics"].join(",")),s.push(["Category","Scans","Clicks","Orders","Avg Value"].join(",")),E.value.forEach(_=>{s.push([`"${_.category}"`,_.totalScans,_.totalClicks,_.totalOrders,`$${_.avgOrderValue.toFixed(2)}`].join(","))}));const e=s.join(`
`),$=new Blob([e],{type:"text/csv;charset=utf-8;"}),j=document.createElement("a"),F=URL.createObjectURL($);j.setAttribute("href",F),j.setAttribute("download",`analytics-report-${new Date().toISOString().split("T")[0]}.csv`),j.style.visibility="hidden",document.body.appendChild(j),j.click(),document.body.removeChild(j),alert("âœ… CSV report downloaded successfully!")}catch(s){console.error("Failed to export CSV:",s),alert("Failed to export CSV. Please try again.")}},bt=async()=>{if(!n.value){D.value="Please enter an email address",N.value="error";return}M.value=!0,D.value="";try{await new Promise(s=>setTimeout(s,1500)),y?(D.value=`âœ… Report will be sent to ${n.value} (Test Mode - Email not actually sent)`,N.value="success",setTimeout(()=>{a.value=!1,n.value="",D.value=""},3e3)):(D.value=`âœ… Report sent successfully to ${n.value}`,N.value="success",setTimeout(()=>{a.value=!1,n.value="",D.value=""},3e3))}catch(s){console.error("Failed to send email report:",s),D.value="Failed to send email report. Please try again.",N.value="error"}finally{M.value=!1}};return(s,e)=>(l(),r("div",Fs,[t("div",Us,[t("div",Hs,[t("div",zs,[t("div",Bs,[e[13]||(e[13]=t("h1",{class:"text-xl font-bold text-gray-900"},"Merchant Dashboard",-1)),W.value?(l(),r("span",qs,o(W.value),1)):R("",!0)]),t("button",{onClick:mt,class:"text-sm text-gray-600 hover:text-gray-900 underline"}," Logout ")]),t("div",Ws,[t("button",{onClick:e[0]||(e[0]=$=>U(m).push("/dashboard")),class:I(["px-4 py-2 text-sm font-medium border-b-2 transition-colors",s.$route.path==="/dashboard"?"border-primary text-primary":"border-transparent text-gray-600 hover:text-gray-900"])}," ðŸ“Š Analytics ",2),t("button",{onClick:e[1]||(e[1]=$=>U(m).push("/menu-management")),class:I(["px-4 py-2 text-sm font-medium border-b-2 transition-colors",s.$route.path==="/menu-management"?"border-primary text-primary":"border-transparent text-gray-600 hover:text-gray-900"])}," ðŸ“‹ Menu ",2),t("button",{onClick:e[2]||(e[2]=$=>U(m).push("/qr")),class:I(["px-4 py-2 text-sm font-medium border-b-2 transition-colors",s.$route.path==="/qr"?"border-primary text-primary":"border-transparent text-gray-600 hover:text-gray-900"])}," ðŸ“± QR Codes ",2),t("button",{onClick:e[3]||(e[3]=$=>U(m).push("/orders")),class:I(["px-4 py-2 text-sm font-medium border-b-2 transition-colors",s.$route.path==="/orders"?"border-primary text-primary":"border-transparent text-gray-600 hover:text-gray-900"])}," ðŸ“‹ Orders ",2),t("button",{onClick:ot,class:"px-4 py-2 text-sm font-medium border-b-2 border-transparent text-gray-600 hover:text-gray-900 transition-colors"}," ðŸ‘ï¸ View Menu ")])])]),t("div",Js,[U(y)?(l(),r("div",Qs,[...e[14]||(e[14]=[t("p",{class:"text-yellow-800 text-center font-medium"}," ðŸ§ª Test Mode - Displaying Sample Analytics Data ",-1)])])):R("",!0),H.value?(l(),r("div",Xs,[...e[15]||(e[15]=[t("div",{class:"text-4xl mb-4"},"â³",-1),t("p",{class:"text-gray-600"},"Loading analytics...",-1)])])):et.value?(l(),r("div",Gs,[e[16]||(e[16]=t("div",{class:"text-4xl mb-4"},"âš ï¸",-1)),e[17]||(e[17]=t("h3",{class:"text-lg font-bold text-red-900 mb-2"},"Failed to Load Analytics",-1)),t("p",Ks,o(et.value),1),t("button",{onClick:G,class:"btn btn-primary"}," Try Again ")])):(l(),r("div",Ys,[t("div",Zs,[t("div",ta,[t("div",ea,[t("div",null,[e[18]||(e[18]=t("p",{class:"text-blue-100 text-sm mb-1"},"Total Scans",-1)),t("p",sa,o(st.value.toLocaleString()),1)]),e[19]||(e[19]=t("div",{class:"text-5xl opacity-50"},"ðŸ“Š",-1))])]),t("div",aa,[t("div",la,[t("div",null,[e[20]||(e[20]=t("p",{class:"text-green-100 text-sm mb-1"},"Total Orders",-1)),t("p",ra,o(at.value.toLocaleString()),1)]),e[21]||(e[21]=t("div",{class:"text-5xl opacity-50"},"ðŸ›’",-1))])]),t("div",oa,[t("div",na,[t("div",null,[e[22]||(e[22]=t("p",{class:"text-purple-100 text-sm mb-1"},"Avg Order Value",-1)),t("p",ia,"$"+o(lt.value.toFixed(2)),1)]),e[23]||(e[23]=t("div",{class:"text-5xl opacity-50"},"ðŸ’°",-1))])]),t("div",da,[t("div",ca,[t("div",null,[e[25]||(e[25]=t("p",{class:"text-orange-100 text-sm mb-1"},"Avg Prep Time",-1)),t("p",ua,[q(o(rt.value.toFixed(1)),1),e[24]||(e[24]=t("span",{class:"text-xl"},"min",-1))])]),e[26]||(e[26]=t("div",{class:"text-5xl opacity-50"},"â±ï¸",-1))])])]),t("div",ya,[t("button",{onClick:pt,class:"btn btn-secondary flex items-center gap-2"},[...e[27]||(e[27]=[t("span",null,"ðŸ“¥",-1),t("span",null,"Export CSV",-1)])]),t("button",{onClick:e[4]||(e[4]=$=>a.value=!0),class:"btn btn-secondary flex items-center gap-2"},[...e[28]||(e[28]=[t("span",null,"ðŸ“§",-1),t("span",null,"Email Report",-1)])])]),X.value&&X.value.length>0?(l(),r("div",ga,[L(bs,{title:"ðŸ’¡ Insights & Recommendations",insights:X.value},null,8,["insights"])])):R("",!0),P.value&&P.value.length>0?(l(),r("div",ma,[L(me,{title:"â° Peak Hours Analysis",data:P.value},null,8,["data"])])):R("",!0),Q.value&&Q.value.length>0?(l(),r("div",xa,[L(De,{title:"ðŸ“ˆ Item Popularity Trends",data:Q.value},null,8,["data"])])):R("",!0),E.value&&E.value.length>0?(l(),r("div",pa,[L(ns,{title:"ðŸ“¦ Category-Level Analytics",data:E.value},null,8,["data"])])):R("",!0),t("div",ba,[L(Ds,{title:"ðŸ“‹ Recent Orders",orders:p.value,"new-order-ids":b.value,"auto-refresh":c.value,onRefresh:B,"onUpdate:autoRefresh":e[5]||(e[5]=$=>c.value=$)},null,8,["orders","new-order-ids","auto-refresh"])]),t("div",va,[L(Wt,{title:"ðŸ† Top Performing Items",items:z.value,limit:10},null,8,["items"])]),t("div",null,[L(Zt,{title:"ðŸ“ˆ Detailed Analytics",columns:ut,data:z.value},null,8,["data"])]),t("div",fa,[e[31]||(e[31]=t("h3",{class:"font-bold text-gray-900 mb-4"},"ðŸ“… Date Range",-1)),t("div",ha,[t("div",null,[e[29]||(e[29]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Start Date ",-1)),V(t("input",{"onUpdate:modelValue":e[6]||(e[6]=$=>v.value=$),type:"date",class:"input"},null,512),[[Y,v.value]])]),t("div",null,[e[30]||(e[30]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," End Date ",-1)),V(t("input",{"onUpdate:modelValue":e[7]||(e[7]=$=>i.value=$),type:"date",class:"input"},null,512),[[Y,i.value]])])]),t("button",{onClick:G,class:"w-full btn btn-primary mt-4"}," Apply Date Range ")]),t("div",$a,[e[35]||(e[35]=t("h3",{class:"font-bold text-gray-900 mb-2"},"â„¹ï¸ Merchant Information",-1)),t("div",_a,[t("p",null,[e[32]||(e[32]=t("strong",null,"Merchant ID:",-1)),q(" "+o(J.value||"N/A"),1)]),t("p",null,[e[33]||(e[33]=t("strong",null,"Business Name:",-1)),q(" "+o(W.value||"N/A"),1)]),t("p",null,[e[34]||(e[34]=t("strong",null,"Menu Items:",-1)),q(" "+o(z.value.length)+" tracked",1)])])]),t("div",wa,[e[36]||(e[36]=t("h3",{class:"font-bold text-blue-900 mb-3"},"ðŸ”— Customer Menu URL",-1)),e[37]||(e[37]=t("p",{class:"text-sm text-blue-700 mb-2"},"Share this URL with your customers:",-1)),t("div",ka,[t("code",Sa,o(K.value),1)]),t("button",{onClick:xt,class:"btn btn-secondary text-sm py-2 px-4"}," ðŸ“‹ Copy URL "),t("button",{onClick:ot,class:"btn btn-primary text-sm py-2 px-4 ml-2"}," ðŸ‘ï¸ Open Menu ")])]))]),a.value?(l(),r("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:e[12]||(e[12]=Ot($=>a.value=!1,["self"]))},[t("div",Ca,[e[42]||(e[42]=t("h3",{class:"text-xl font-bold mb-4"},"ðŸ“§ Email Analytics Report",-1)),t("div",Aa,[t("div",null,[e[38]||(e[38]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Email Address ",-1)),V(t("input",{"onUpdate:modelValue":e[8]||(e[8]=$=>n.value=$),type:"email",placeholder:"your@email.com",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"},null,512),[[Y,n.value]])]),t("div",null,[e[40]||(e[40]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Report Type ",-1)),V(t("select",{"onUpdate:modelValue":e[9]||(e[9]=$=>x.value=$),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"},[...e[39]||(e[39]=[t("option",{value:"daily"},"Daily Summary",-1),t("option",{value:"weekly"},"Weekly Summary",-1),t("option",{value:"monthly"},"Monthly Summary",-1)])],512),[[ct,x.value]])]),t("div",Ia,[V(t("input",{type:"checkbox",id:"emailSchedule","onUpdate:modelValue":e[10]||(e[10]=$=>w.value=$),class:"rounded"},null,512),[[Tt,w.value]]),e[41]||(e[41]=t("label",{for:"emailSchedule",class:"text-sm text-gray-700"}," Schedule recurring reports ",-1))])]),t("div",Oa,[t("button",{onClick:bt,class:"flex-1 btn btn-primary",disabled:!n.value||M.value},o(M.value?"Sending...":"Send Report"),9,Ta),t("button",{onClick:e[11]||(e[11]=$=>a.value=!1),class:"flex-1 btn btn-secondary"}," Cancel ")]),D.value?(l(),r("div",{key:0,class:I(["mt-4 p-3 rounded",N.value==="success"?"bg-green-50 text-green-700":"bg-red-50 text-red-700"])},o(D.value),3)):R("",!0)])])):R("",!0),L(Es,{notification:f.value,onClose:gt},null,8,["notification"])]))}};export{ja as default};
